<section class="card border-0 shadow-sm">
  <div class="card-body p-4 p-md-5">
    <div class="d-flex flex-wrap justify-content-between align-items-end gap-3 mb-3">
      <div>
        <h1 class="h3 mb-1">Потребителски профили</h1>
        <p class="text-secondary mb-0">Преглед и редакция на профили според правата за достъп.</p>
      </div>
      <div style="min-width: 260px;">
        <label for="user-profiles-search" class="form-label mb-1">Търсене</label>
        <input id="user-profiles-search" type="text" class="form-control form-control-sm" placeholder="Търси по username, email, име" />
      </div>
    </div>

    <div class="table-responsive tch-card-grid">
      <table class="table align-middle mb-0">
        <thead>
          <tr>
            <th>Потребителско име</th>
            <th>Имейл</th>
            <th>Име</th>
            <th>Служител</th>
            <th class="text-end">Действия</th>
          </tr>
        </thead>
        <tbody id="user-profiles-table-body"></tbody>
      </table>
    </div>
    <p id="user-profiles-empty" class="text-secondary d-none mt-3 mb-0"></p>

    <nav id="user-profiles-pagination" class="d-none d-flex align-items-center justify-content-between mt-3" aria-label="Пейджиране">
      <button id="user-profiles-pagination-prev" type="button" class="btn btn-sm btn-outline-secondary"><i class="bi bi-chevron-left me-1"></i>Назад</button>
      <div id="user-profiles-pagination-label" class="text-secondary small"></div>
      <button id="user-profiles-pagination-next" type="button" class="btn btn-sm btn-outline-secondary">Напред<i class="bi bi-chevron-right ms-1"></i></button>
    </nav>
  </div>
</section>

<div id="user-profile-view-modal" class="d-none position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-50" style="z-index: 1060;">
  <div class="d-flex align-items-center justify-content-center h-100 p-3">
    <div class="card w-100" style="max-width: 680px;">
      <div class="card-body p-4">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h2 class="h5 mb-0">Преглед на профил</h2>
          <button id="user-profile-view-close" type="button" class="btn-close" aria-label="Close"></button>
        </div>

        <div class="row g-3">
          <div class="col-md-6">
            <div class="border rounded p-3">
              <div class="text-secondary small">Потребителско име</div>
              <div id="user-profile-view-username" class="fw-semibold">-</div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="border rounded p-3">
              <div class="text-secondary small">Имейл</div>
              <div id="user-profile-view-email" class="fw-semibold">-</div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="border rounded p-3">
              <div class="text-secondary small">Собствено име</div>
              <div id="user-profile-view-first-name" class="fw-semibold">-</div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="border rounded p-3">
              <div class="text-secondary small">Фамилия</div>
              <div id="user-profile-view-last-name" class="fw-semibold">-</div>
            </div>
          </div>
          <div class="col-12">
            <div class="border rounded p-3">
              <div class="text-secondary small">Свързан служител</div>
              <div id="user-profile-view-employee" class="fw-semibold">-</div>
            </div>
          </div>
        </div>

        <div class="d-flex justify-content-end mt-4">
          <button id="user-profile-view-close-secondary" type="button" class="btn btn-outline-secondary">Затвори</button>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="user-profile-edit-modal" class="d-none position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-50" style="z-index: 1060;">
  <div class="d-flex align-items-center justify-content-center h-100 p-3">
    <div class="card w-100" style="max-width: 680px;">
      <div class="card-body p-4">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h2 class="h5 mb-0">Редакция на профил</h2>
          <button id="user-profile-edit-close" type="button" class="btn-close" aria-label="Close"></button>
        </div>

        <form id="user-profile-edit-form" class="row g-3">
          <input id="user-profile-edit-id" type="hidden" />

          <div class="col-md-6">
            <label for="user-profile-edit-username" class="form-label">Потребителско име</label>
            <input id="user-profile-edit-username" type="text" class="form-control" required minlength="3" maxlength="30" pattern="^[A-Za-z0-9_]{3,30}$" />
          </div>

          <div class="col-md-6">
            <label for="user-profile-edit-email" class="form-label">Имейл</label>
            <input id="user-profile-edit-email" type="email" class="form-control" required />
          </div>

          <div class="col-md-6">
            <label for="user-profile-edit-first-name" class="form-label">Собствено име</label>
            <input id="user-profile-edit-first-name" type="text" class="form-control" required />
          </div>

          <div class="col-md-6">
            <label for="user-profile-edit-last-name" class="form-label">Фамилия</label>
            <input id="user-profile-edit-last-name" type="text" class="form-control" required />
          </div>

          <div id="user-profile-password-wrap" class="col-12 d-none">
            <div class="border rounded p-3">
              <div class="text-secondary small mb-2">Смяна на парола</div>
              <div class="row g-3">
                <div class="col-md-6">
                  <label for="user-profile-edit-new-password" class="form-label">Нова парола</label>
                  <div class="input-group">
                    <input
                      id="user-profile-edit-new-password"
                      type="password"
                      class="form-control"
                      minlength="6"
                      pattern="^(?!.*[\u0400-\u04FF]).*$"
                      title="Паролата не трябва да съдържа кирилица"
                    />
                    <button
                      type="button"
                      class="btn btn-outline-secondary"
                      data-toggle-password="user-profile-edit-new-password"
                      aria-label="Покажи новата парола"
                    >
                      <i class="bi bi-eye"></i>
                    </button>
                  </div>
                </div>
                <div class="col-md-6">
                  <label for="user-profile-edit-confirm-password" class="form-label">Потвърди нова парола</label>
                  <div class="input-group">
                    <input
                      id="user-profile-edit-confirm-password"
                      type="password"
                      class="form-control"
                      minlength="6"
                      pattern="^(?!.*[\u0400-\u04FF]).*$"
                      title="Паролата не трябва да съдържа кирилица"
                    />
                    <button
                      type="button"
                      class="btn btn-outline-secondary"
                      data-toggle-password="user-profile-edit-confirm-password"
                      aria-label="Покажи потвърждението на новата парола"
                    >
                      <i class="bi bi-eye"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="form-text mt-2">Остави празно, ако не искаш смяна на паролата.</div>
            </div>
          </div>

          <div id="user-profile-edit-employee-wrap" class="col-12 d-none">
            <label for="user-profile-edit-employee-id" class="form-label">Свързан служител</label>
            <select id="user-profile-edit-employee-id" class="form-select">
              <option value="">Без свързан служител</option>
            </select>
          </div>

          <div class="col-12 d-flex justify-content-end gap-2 mt-2">
            <button id="user-profile-edit-cancel" type="button" class="btn btn-outline-secondary">Отказ</button>
            <button id="user-profile-edit-save" type="submit" class="btn btn-primary">Запази</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<div id="user-profile-reset-confirm-modal" class="d-none position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-50" style="z-index: 1060;">
  <div class="d-flex align-items-center justify-content-center h-100 p-3">
    <div class="card w-100" style="max-width: 520px;">
      <div class="card-body p-4">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h2 class="h5 mb-0">Потвърждение</h2>
          <button id="user-profile-reset-confirm-close" type="button" class="btn-close" aria-label="Close"></button>
        </div>

        <p id="user-profile-reset-confirm-message" class="mb-4">Сигурни ли сте, че искате да изпратите линк?</p>

        <div class="d-flex justify-content-end gap-2">
          <button id="user-profile-reset-confirm-cancel" type="button" class="btn btn-outline-secondary">Отказ</button>
          <button id="user-profile-reset-confirm-accept" type="button" class="btn btn-warning">Изпрати</button>
        </div>
      </div>
    </div>
  </div>
</div>
